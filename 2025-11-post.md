---
title: 'Evaluating AI-based molecular modelling with Physical Simulation'
author: Hao Lan
date: 2025-10-26
permalink: /posts/2025-11-XX/
tags:
  - Statictical Mechanics (Force Field) and Quantum Mechanics (DFT)
  - Atomic Neural Network Potentials
  - Enhanced Molecular Dynamics
---

## Introduction
<p style="text-align: justify;">
In my last blog post, I tested AI co-folding model for novel chemical modalities including macrocyclic molecular glue and its induced protein complexes. There are some postive feedback but no much detailed investigation was performed. As a computational chemist and cheminformation, I found it would be interesting to study and analyse these models with physics in terms of sampling effiency and energy accuracy, which could guide some practical applications in drug discovery industry. Hence, in this new article I would like to make some complementarity and particularly focus on two questions:

1. Which are those 'good' AI models approaching physics and also with low computational cost?

2. Can physics help to identify, refine or even rescure those 'imperfect' AI models?   
</p>

## Key Conclusions at the Begining

a. Some latest machine learning force fields (MMFFs) based on atomic neural network potentials (NNPs) reach quantum mechanics (QM) accurary for small molecules. They could be used as DFT surragate for energy calculation quickly, despite their speed for simulation still largely inferior to those traditional force fields with classic parameterations. Moreover, the fundamental architecture of NNPs might further restrict its usage in coupled with enhanced sampling techniques such as Hamiliton replica exchange MD or metadynamics.

b. Traditional statistical mechanics could deal with most challenging chemcial systems, but there are some tricky situations (e.g., antropisomer) that require extra cautions. If such scenario was wrongly generated by AI, it would be even more hard for physical modelling to rescure.

c. Some mature machine learning models for predicting atomic properties in cheminformatics show direct benefits on computational chemistry (though in subconscious way), some of which have accelerated simulation workflow efficiently and made previously impossible parameterisation to be feasible.

d. The popular AI co-folding model provided hypothesis in a quick and easy way (if ignore the cost of data and training), of which structures could be further evaluated by more expensive physics in order to identify and reduce false postive results.

## Ligand Conformational Analysis in Solution

For organic small molecule drugs, solution-state conformations play important roles on both receptor binding events and DMPK properties. Computational/medicinal chemists often apply strategies of conformation control to restrain or even lock bioactive state in solution for reducing entropic pentalty and enhancing binding affinity on certain target. For modalities beyond the rule of five (bRo5), their folding conformations are also critical for desired permabilities and solubilities (defined as 'Chameleonicity' by Kihlberg group...) Following my previous article, I decided to use Elironrasib (Figure 1), such macrocyclic MG modality again, for solution-state conformational analysis with enhanced molecular dynamics simultion and also test the performance of several force fields including atomic NNPs by their simulation speed and accuaracy relative to QM/DFT-level energies.
<img /><br>

### Choice of Sampling Approach and Force Fields

In small molecule simulation field, both Monte Carlo and molecular dynamics are commonly used for modelling. During my PhD few years ago, MacroModel (a software developed by Still group based on Metropolis Monte Carlo, later acquired by Schrodinger together with OPLSx force field from Jorgensen group) was always my first choice to sample multiple minima of conformer used for NMR structure elucidation. However, the pure monte carlo algorithm could only deal with the system with limited degrees of freedom (usually just solute with implicit solvation model for easy convergence) and I have gradually realised the importance of explicit waters for CADD during these years in industry. Therefore, molecular dynamics with explicit waters were chosen for this study. 

The large languague models like Gemini has suggested me with several softwares and methods for such computational modelling. With the spirit of open source and also for this personal blog, I determinied to use gromacs, openmm, openff, xtb, orca, pytorch and other non-commerical modules (at least free for personal use) which I have the most experience with since my PhD.

Here are four force fields used in this test:

1. General AMBER Force Field (GAFF) - a conventional small-molecule force field compatible with well-known AMBER family
2. SAGE (OpenFF-2.2.1) - the latest generation of small-molecule force field released by Open Force Field Initiative
3. ANI2x - an atomic neural network potential (NNP) in pioneer ANI family for simulation
4. MACE - a series of new NNPs for computational chemistry (herein only its distilled small model was used for simulation feasibly) 